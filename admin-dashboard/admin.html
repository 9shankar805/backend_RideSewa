<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InDrive Admin Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f5f5; }
        .header { background: #2c3e50; color: white; padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; }
        .header h1 { font-size: 1.5rem; }
        .header .status { background: #27ae60; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.8rem; }
        .container { max-width: 1400px; margin: 0 auto; padding: 2rem; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
        .stat-card { background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .stat-card h3 { color: #7f8c8d; font-size: 0.9rem; margin-bottom: 0.5rem; }
        .stat-card .value { font-size: 2rem; font-weight: bold; color: #2c3e50; }
        .stat-card.rides .value { color: #3498db; }
        .stat-card.drivers .value { color: #27ae60; }
        .stat-card.revenue .value { color: #e74c3c; }
        .stat-card.users .value { color: #9b59b6; }
        .tabs { display: flex; background: white; border-radius: 10px; margin-bottom: 2rem; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .tab { padding: 1rem 2rem; cursor: pointer; border: none; background: none; font-size: 1rem; transition: all 0.3s; }
        .tab.active { background: #3498db; color: white; }
        .tab:hover { background: #ecf0f1; }
        .tab.active:hover { background: #2980b9; }
        .content { background: white; border-radius: 10px; padding: 2rem; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .table { width: 100%; border-collapse: collapse; }
        .table th, .table td { padding: 1rem; text-align: left; border-bottom: 1px solid #ecf0f1; }
        .table th { background: #f8f9fa; font-weight: 600; color: #2c3e50; }
        .table tr:hover { background: #f8f9fa; }
        .btn { padding: 0.5rem 1rem; border: none; border-radius: 5px; cursor: pointer; font-size: 0.9rem; transition: all 0.3s; }
        .btn-primary { background: #3498db; color: white; }
        .btn-success { background: #27ae60; color: white; }
        .btn-danger { background: #e74c3c; color: white; }
        .btn-warning { background: #f39c12; color: white; }
        .btn:hover { opacity: 0.8; transform: translateY(-1px); }
        .status-badge { padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.8rem; font-weight: 500; }
        .status-online { background: #d5f4e6; color: #27ae60; }
        .status-offline { background: #fadbd8; color: #e74c3c; }
        .status-pending { background: #fef9e7; color: #f39c12; }
        .status-completed { background: #d5f4e6; color: #27ae60; }
        .status-in_progress { background: #e3f2fd; color: #2196f3; }
        .status-busy { background: #fff3e0; color: #ff9800; }
        .form-group { margin-bottom: 1rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50; }
        .form-control { width: 100%; padding: 0.8rem; border: 1px solid #ddd; border-radius: 5px; font-size: 1rem; }
        .form-control:focus { outline: none; border-color: #3498db; box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2); }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }
        .modal-content { background: white; margin: 5% auto; padding: 2rem; border-radius: 10px; max-width: 500px; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .close { font-size: 1.5rem; cursor: pointer; }
        .loading { text-align: center; padding: 2rem; color: #7f8c8d; }
        .error { background: #fadbd8; color: #e74c3c; padding: 1rem; border-radius: 5px; margin-bottom: 1rem; }
        .success { background: #d5f4e6; color: #27ae60; padding: 1rem; border-radius: 5px; margin-bottom: 1rem; }
        .chart-container { height: 300px; margin: 1rem 0; }
        .hidden { display: none; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; }
        .card { background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .actions { display: flex; gap: 0.5rem; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üöó InDrive Admin Dashboard</h1>
        <div class="status" id="serverStatus">üü¢ Online</div>
    </div>

    <div class="container">
        <!-- Stats Overview -->
        <div class="stats-grid" id="statsGrid">
            <div class="stat-card rides">
                <h3>Total Rides</h3>
                <div class="value" id="totalRides">Loading...</div>
            </div>
            <div class="stat-card drivers">
                <h3>Active Drivers</h3>
                <div class="value" id="activeDrivers">Loading...</div>
            </div>
            <div class="stat-card users">
                <h3>Total Users</h3>
                <div class="value" id="totalUsers">Loading...</div>
            </div>
            <div class="stat-card revenue">
                <h3>Today's Revenue</h3>
                <div class="value" id="todayRevenue">Loading...</div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('dashboard')">üìä Dashboard</button>
            <button class="tab" onclick="showTab('rides')">üöó Rides</button>
            <button class="tab" onclick="showTab('drivers')">üë®üíº Drivers</button>
            <button class="tab" onclick="showTab('users')">üë• Users</button>
            <button class="tab" onclick="showTab('analytics')">üìà Analytics</button>
            <button class="tab" onclick="showTab('settings')">‚öôÔ∏è Settings</button>
        </div>

        <!-- Content Areas -->
        <div class="content">
            <!-- Dashboard Tab -->
            <div id="dashboard-content" class="tab-content">
                <h2>System Overview</h2>
                <div class="grid">
                    <div class="card">
                        <h3>üöó Recent Rides</h3>
                        <div id="recentRides">Loading...</div>
                    </div>
                    <div class="card">
                        <h3>üë®üíº Driver Applications</h3>
                        <div id="driverApplications">Loading...</div>
                    </div>
                    <div class="card">
                        <h3>üé´ Support Tickets</h3>
                        <div id="supportTickets">Loading...</div>
                    </div>
                    <div class="card">
                        <h3>üìä System Health</h3>
                        <div id="systemHealth">Loading...</div>
                    </div>
                </div>
            </div>

            <!-- Rides Tab -->
            <div id="rides-content" class="tab-content hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h2>Ride Management</h2>
                    <button class="btn btn-primary" onclick="refreshRides()">üîÑ Refresh</button>
                </div>
                <table class="table" id="ridesTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Passenger</th>
                            <th>Driver</th>
                            <th>From</th>
                            <th>To</th>
                            <th>Fare</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="ridesTableBody">
                        <tr><td colspan="8" class="loading">Loading rides...</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- Drivers Tab -->
            <div id="drivers-content" class="tab-content hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h2>Driver Management</h2>
                    <div>
                        <button class="btn btn-success" onclick="showDriverApplications()">üìã Applications</button>
                        <button class="btn btn-primary" onclick="refreshDrivers()">üîÑ Refresh</button>
                    </div>
                </div>
                <table class="table" id="driversTable">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Phone</th>
                            <th>Vehicle</th>
                            <th>Status</th>
                            <th>Rating</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="driversTableBody">
                        <tr><td colspan="7" class="loading">Loading drivers...</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- Users Tab -->
            <div id="users-content" class="tab-content hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h2>User Management</h2>
                    <button class="btn btn-primary" onclick="refreshUsers()">üîÑ Refresh</button>
                </div>
                <table class="table" id="usersTable">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Type</th>
                            <th>Joined</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody">
                        <tr><td colspan="6" class="loading">Loading users...</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- Analytics Tab -->
            <div id="analytics-content" class="tab-content hidden">
                <h2>Analytics & Reports</h2>
                <div class="grid">
                    <div class="card">
                        <h3>üìä Revenue Analytics</h3>
                        <div class="chart-container" id="revenueChart">Loading chart...</div>
                    </div>
                    <div class="card">
                        <h3>üöó Ride Statistics</h3>
                        <div class="chart-container" id="rideChart">Loading chart...</div>
                    </div>
                    <div class="card">
                        <h3>üë®üíº Driver Performance</h3>
                        <div id="driverPerformance">Loading...</div>
                    </div>
                    <div class="card">
                        <h3>üìà Growth Metrics</h3>
                        <div id="growthMetrics">Loading...</div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings-content" class="tab-content hidden">
                <h2>System Settings</h2>
                <div class="grid">
                    <div class="card">
                        <h3>‚öôÔ∏è App Configuration</h3>
                        <div class="form-group">
                            <label>Commission Rate (%)</label>
                            <input type="number" class="form-control" id="commissionRate" value="15">
                        </div>
                        <div class="form-group">
                            <label>Base Fare ($)</label>
                            <input type="number" class="form-control" id="baseFare" value="2.50">
                        </div>
                        <div class="form-group">
                            <label>Per KM Rate ($)</label>
                            <input type="number" class="form-control" id="perKmRate" value="1.20">
                        </div>
                        <button class="btn btn-success" onclick="saveSettings()">üíæ Save Settings</button>
                    </div>
                    <div class="card">
                        <h3>üîß System Controls</h3>
                        <div class="form-group">
                            <button class="btn btn-warning" onclick="runMaintenance()">üîß Run Maintenance</button>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-primary" onclick="clearCache()">üóëÔ∏è Clear Cache</button>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-danger" onclick="exportData()">üì§ Export Data</button>
                        </div>
                    </div>
                    <div class="card">
                        <h3>üìä System Status</h3>
                        <div id="systemStatus">Loading...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Driver Applications -->
    <div id="applicationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Driver Application</h3>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <div id="applicationDetails">Loading...</div>
            <div style="margin-top: 1rem;">
                <button class="btn btn-success" onclick="approveApplication()">‚úÖ Approve</button>
                <button class="btn btn-danger" onclick="rejectApplication()">‚ùå Reject</button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentApplicationId = null;
        const API_BASE = window.location.origin;

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            loadDashboardData();
            setInterval(loadDashboardData, 30000); // Refresh every 30 seconds
        });

        // Tab management
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName + '-content').classList.remove('hidden');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
            
            // Load tab-specific data
            switch(tabName) {
                case 'rides':
                    loadRides();
                    break;
                case 'drivers':
                    loadDrivers();
                    break;
                case 'users':
                    loadUsers();
                    break;
                case 'analytics':
                    loadAnalytics();
                    break;
                case 'settings':
                    loadSettings();
                    break;
            }
        }

        // Load dashboard data
        async function loadDashboardData() {
            try {
                const response = await fetch(`${API_BASE}/health`);
                const data = await response.json();
                
                if (data.status === 'healthy') {
                    document.getElementById('serverStatus').innerHTML = 'üü¢ Online';
                    document.getElementById('serverStatus').style.background = '#27ae60';
                } else {
                    document.getElementById('serverStatus').innerHTML = 'üî¥ Issues';
                    document.getElementById('serverStatus').style.background = '#e74c3c';
                }
                
                // Load stats
                loadStats();
                loadRecentActivity();
                
            } catch (error) {
                console.error('Error loading dashboard:', error);
                document.getElementById('serverStatus').innerHTML = 'üî¥ Offline';
                document.getElementById('serverStatus').style.background = '#e74c3c';
            }
        }

        // Load statistics
        async function loadStats() {
            try {
                const response = await fetch(`${API_BASE}/api/admin/dashboard`);
                const data = await response.json();
                
                document.getElementById('totalRides').textContent = data.totalRides.toLocaleString();
                document.getElementById('activeDrivers').textContent = data.activeDrivers;
                document.getElementById('totalUsers').textContent = data.totalUsers.toLocaleString();
                document.getElementById('todayRevenue').textContent = `$${data.todayRevenue.toLocaleString()}`;
            } catch (error) {
                console.error('Error loading stats:', error);
                document.getElementById('totalRides').textContent = 'Error';
                document.getElementById('activeDrivers').textContent = 'Error';
                document.getElementById('totalUsers').textContent = 'Error';
                document.getElementById('todayRevenue').textContent = 'Error';
            }
        }

        // Load recent activity
        async function loadRecentActivity() {
            try {
                const response = await fetch(`${API_BASE}/api/admin/dashboard`);
                const data = await response.json();
                
                // Recent Rides
                let ridesHtml = '<div style="font-size: 0.9rem; color: #7f8c8d;">Recent rides:</div><div style="margin-top: 0.5rem;">';
                data.recentRides.slice(0, 3).forEach(ride => {
                    ridesHtml += `<div>üöó ${ride.passenger} ‚Üí $${ride.fare}</div>`;
                });
                ridesHtml += '</div>';
                document.getElementById('recentRides').innerHTML = ridesHtml;
                
                // Driver Applications
                const pendingApps = data.driverApplications.filter(app => app.status === 'pending').length;
                document.getElementById('driverApplications').innerHTML = `
                    <div style="font-size: 0.9rem; color: #7f8c8d;">Pending: ${pendingApps} applications</div>
                    <button class="btn btn-primary" style="margin-top: 0.5rem; font-size: 0.8rem;" onclick="showDriverApplications()">Review</button>
                `;
                
                // Support Tickets
                const openTickets = data.supportTickets.filter(ticket => ticket.status === 'open').length;
                let ticketsHtml = `<div style="font-size: 0.9rem; color: #7f8c8d;">Open tickets: ${openTickets}</div><div style="margin-top: 0.5rem; font-size: 0.8rem;">`;
                data.supportTickets.slice(0, 2).forEach(ticket => {
                    ticketsHtml += `üé´ ${ticket.subject}<br>`;
                });
                ticketsHtml += '</div>';
                document.getElementById('supportTickets').innerHTML = ticketsHtml;
                
                // System Health
                const health = data.systemHealth;
                document.getElementById('systemHealth').innerHTML = `
                    <div style="font-size: 0.9rem;">
                        <div>üü¢ Database: ${health.database}</div>
                        <div>üü° Redis: ${health.redis}</div>
                        <div>üü¢ API: ${health.api}</div>
                        <div>üìä Uptime: ${health.uptime}</div>
                    </div>
                `;
            } catch (error) {
                console.error('Error loading recent activity:', error);
                document.getElementById('recentRides').innerHTML = 'Error loading data';
                document.getElementById('driverApplications').innerHTML = 'Error loading data';
                document.getElementById('supportTickets').innerHTML = 'Error loading data';
                document.getElementById('systemHealth').innerHTML = 'Error loading data';
            }
        }

        // Load rides
        async function loadRides() {
            try {
                const response = await fetch(`${API_BASE}/api/rides`);
                const rides = await response.json();
                
                const tbody = document.getElementById('ridesTableBody');
                if (rides.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="8" class="loading">No rides found</td></tr>';
                    return;
                }
                
                tbody.innerHTML = rides.map(ride => `
                    <tr>
                        <td>${ride.id}</td>
                        <td>${ride.passenger}</td>
                        <td>${ride.driver}</td>
                        <td>${ride.from}</td>
                        <td>${ride.to}</td>
                        <td>$${ride.fare}</td>
                        <td><span class="status-badge status-${ride.status}">${ride.status.replace('_', ' ')}</span></td>
                        <td>
                            <div class="actions">
                                <button class="btn btn-primary" onclick="viewRide('${ride.id}')">View</button>
                                ${ride.status === 'pending' ? `<button class="btn btn-danger" onclick="cancelRide('${ride.id}')">Cancel</button>` : ''}
                            </div>
                        </td>
                    </tr>
                `).join('');
            } catch (error) {
                console.error('Error loading rides:', error);
                document.getElementById('ridesTableBody').innerHTML = '<tr><td colspan="8" class="error">Error loading rides</td></tr>';
            }
        }

        // Load drivers
        async function loadDrivers() {
            try {
                const response = await fetch(`${API_BASE}/api/drivers`);
                const drivers = await response.json();
                
                const tbody = document.getElementById('driversTableBody');
                if (drivers.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="7" class="loading">No drivers found</td></tr>';
                    return;
                }
                
                tbody.innerHTML = drivers.map(driver => `
                    <tr>
                        <td>${driver.name}</td>
                        <td>${driver.email}</td>
                        <td>${driver.phone}</td>
                        <td>${driver.vehicle}</td>
                        <td><span class="status-badge status-${driver.status}">${driver.status}</span></td>
                        <td>${driver.rating} ‚≠ê</td>
                        <td>
                            <div class="actions">
                                <button class="btn btn-primary" onclick="viewDriver('${driver.id}')">View</button>
                                ${driver.status === 'online' ? 
                                    `<button class="btn btn-warning" onclick="suspendDriver('${driver.id}')">Suspend</button>` :
                                    `<button class="btn btn-success" onclick="activateDriver('${driver.id}')">Activate</button>`
                                }
                            </div>
                        </td>
                    </tr>
                `).join('');
            } catch (error) {
                console.error('Error loading drivers:', error);
                document.getElementById('driversTableBody').innerHTML = '<tr><td colspan="7" class="error">Error loading drivers</td></tr>';
            }
        }

        // Load users
        async function loadUsers() {
            try {
                const response = await fetch(`${API_BASE}/api/users`);
                const users = await response.json();
                
                const tbody = document.getElementById('usersTableBody');
                if (users.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="6" class="loading">No users found</td></tr>';
                    return;
                }
                
                tbody.innerHTML = users.map(user => `
                    <tr>
                        <td>${user.name}</td>
                        <td>${user.email}</td>
                        <td>Passenger</td>
                        <td>${user.joined}</td>
                        <td><span class="status-badge status-${user.status === 'active' ? 'online' : 'offline'}">${user.status}</span></td>
                        <td>
                            <div class="actions">
                                <button class="btn btn-primary" onclick="viewUser('${user.id}')">View</button>
                                ${user.status === 'active' ? 
                                    `<button class="btn btn-warning" onclick="suspendUser('${user.id}')">Suspend</button>` :
                                    `<button class="btn btn-success" onclick="activateUser('${user.id}')">Activate</button>`
                                }
                            </div>
                        </td>
                    </tr>
                `).join('');
            } catch (error) {
                console.error('Error loading users:', error);
                document.getElementById('usersTableBody').innerHTML = '<tr><td colspan="6" class="error">Error loading users</td></tr>';
            }
        }

        // Load analytics
        async function loadAnalytics() {
            try {
                const response = await fetch(`${API_BASE}/api/analytics/overview`);
                const data = await response.json();
                
                document.getElementById('revenueChart').innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #7f8c8d;">
                        üìä Revenue Chart<br>
                        <div style="margin-top: 1rem; font-size: 1.2rem;">$${data.weeklyRevenue.reduce((a,b) => a+b, 0).toLocaleString()} this week</div>
                        <div style="font-size: 0.9rem; color: #27ae60;">‚ÜóÔ∏è Weekly average: $${Math.round(data.weeklyRevenue.reduce((a,b) => a+b, 0) / 7)}</div>
                    </div>
                `;
                
                document.getElementById('rideChart').innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #7f8c8d;">
                        üöó Ride Statistics<br>
                        <div style="margin-top: 1rem; font-size: 1.2rem;">${data.dailyRides.reduce((a,b) => a+b, 0)} rides this week</div>
                        <div style="font-size: 0.9rem; color: #27ae60;">‚ÜóÔ∏è Daily average: ${Math.round(data.dailyRides.reduce((a,b) => a+b, 0) / 7)}</div>
                    </div>
                `;
                
                let performanceHtml = '<div style="font-size: 0.9rem;">';
                data.driverPerformance.forEach(driver => {
                    performanceHtml += `<div>üèÜ ${driver.name}: ${driver.rides} rides, $${driver.earnings}</div>`;
                });
                performanceHtml += '</div>';
                document.getElementById('driverPerformance').innerHTML = performanceHtml;
                
                document.getElementById('growthMetrics').innerHTML = `
                    <div style="font-size: 0.9rem;">
                        <div>üë• Total Users: ${data.userGrowth[data.userGrowth.length - 1].toLocaleString()}</div>
                        <div>üìà Growth: +${data.userGrowth[data.userGrowth.length - 1] - data.userGrowth[data.userGrowth.length - 2]} this period</div>
                        <div>üì± User Retention: 85%</div>
                        <div>üí∞ Revenue Growth: +12%</div>
                    </div>
                `;
            } catch (error) {
                console.error('Error loading analytics:', error);
                document.getElementById('revenueChart').innerHTML = 'Error loading chart';
                document.getElementById('rideChart').innerHTML = 'Error loading chart';
                document.getElementById('driverPerformance').innerHTML = 'Error loading data';
                document.getElementById('growthMetrics').innerHTML = 'Error loading data';
            }
        }

        // Load settings
        async function loadSettings() {
            try {
                const response = await fetch(`${API_BASE}/api/settings`);
                const settings = await response.json();
                
                document.getElementById('commissionRate').value = settings.commissionRate * 100;
                document.getElementById('baseFare').value = settings.baseFare;
                document.getElementById('perKmRate').value = settings.perKmRate;
                
                document.getElementById('systemStatus').innerHTML = `
                    <div style="font-size: 0.9rem;">
                        <div>üñ•Ô∏è Server: Running</div>
                        <div>üíæ Database: Connected</div>
                        <div>üóÑÔ∏è Cache: Active</div>
                        <div>üåê APIs: Operational</div>
                        <div>üìß Email: Limited</div>
                        <div>üì± SMS: Disabled</div>
                    </div>
                `;
            } catch (error) {
                console.error('Error loading settings:', error);
                document.getElementById('systemStatus').innerHTML = 'Error loading system status';
            }
        }

        // Action functions
        function viewRide(rideId) {
            showNotification(`Viewing ride ${rideId}`, 'success');
        }
        
        function cancelRide(rideId) {
            if (confirm('Are you sure you want to cancel this ride?')) {
                fetch(`${API_BASE}/api/rides/${rideId}/cancel`, { method: 'POST' })
                .then(() => {
                    showNotification('Ride cancelled successfully', 'success');
                    loadRides();
                })
                .catch(error => showNotification('Error cancelling ride', 'error'));
            }
        }
        
        function viewDriver(driverId) {
            showNotification(`Viewing driver ${driverId}`, 'success');
        }
        
        function suspendDriver(driverId) {
            if (confirm('Are you sure you want to suspend this driver?')) {
                fetch(`${API_BASE}/api/drivers/${driverId}/suspend`, { method: 'POST' })
                .then(() => {
                    showNotification('Driver suspended successfully', 'success');
                    loadDrivers();
                })
                .catch(error => showNotification('Error suspending driver', 'error'));
            }
        }
        
        function activateDriver(driverId) {
            fetch(`${API_BASE}/api/drivers/${driverId}/approve`, { method: 'POST' })
            .then(() => {
                showNotification('Driver activated successfully', 'success');
                loadDrivers();
            })
            .catch(error => showNotification('Error activating driver', 'error'));
        }
        
        function viewUser(userId) {
            showNotification(`Viewing user ${userId}`, 'success');
        }
        
        function suspendUser(userId) {
            if (confirm('Are you sure you want to suspend this user?')) {
                fetch(`${API_BASE}/api/users/${userId}/suspend`, { method: 'POST' })
                .then(() => {
                    showNotification('User suspended successfully', 'success');
                    loadUsers();
                })
                .catch(error => showNotification('Error suspending user', 'error'));
            }
        }
        
        function activateUser(userId) {
            showNotification('User activated successfully', 'success');
            loadUsers();
        }

        // Utility functions
        function refreshRides() {
            loadRides();
            showNotification('Rides refreshed', 'success');
        }

        function refreshDrivers() {
            loadDrivers();
            showNotification('Drivers refreshed', 'success');
        }

        function refreshUsers() {
            loadUsers();
            showNotification('Users refreshed', 'success');
        }

        function showDriverApplications() {
            document.getElementById('applicationModal').style.display = 'block';
            document.getElementById('applicationDetails').innerHTML = `
                <div>
                    <h4>Driver Application #DA001</h4>
                    <p><strong>Name:</strong> Alex Rodriguez</p>
                    <p><strong>Email:</strong> alex@example.com</p>
                    <p><strong>Phone:</strong> +1234567892</p>
                    <p><strong>Vehicle:</strong> 2020 Honda Accord</p>
                    <p><strong>License:</strong> Valid until 2026</p>
                    <p><strong>Insurance:</strong> Valid until 2025</p>
                </div>
            `;
            currentApplicationId = 'DA001';
        }

        function closeModal() {
            document.getElementById('applicationModal').style.display = 'none';
        }

        function approveApplication() {
            showNotification('Application approved successfully', 'success');
            closeModal();
        }

        function rejectApplication() {
            showNotification('Application rejected', 'error');
            closeModal();
        }

        function saveSettings() {
            const settings = {
                commissionRate: parseFloat(document.getElementById('commissionRate').value) / 100,
                baseFare: parseFloat(document.getElementById('baseFare').value),
                perKmRate: parseFloat(document.getElementById('perKmRate').value)
            };
            
            fetch(`${API_BASE}/api/settings`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(settings)
            })
            .then(response => response.json())
            .then(data => {
                showNotification('Settings saved successfully', 'success');
            })
            .catch(error => {
                console.error('Error saving settings:', error);
                showNotification('Error saving settings', 'error');
            });
        }

        function runMaintenance() {
            showNotification('Maintenance completed', 'success');
        }

        function clearCache() {
            showNotification('Cache cleared successfully', 'success');
        }

        function exportData() {
            showNotification('Data export started', 'success');
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = type === 'success' ? 'success' : 'error';
            notification.textContent = message;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '9999';
            notification.style.padding = '1rem';
            notification.style.borderRadius = '5px';
            notification.style.boxShadow = '0 2px 10px rgba(0,0,0,0.2)';
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 3000);
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('applicationModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }
    </script>
</body>
</html>